
<%= search_form_for @search do |f| %>
  <div class="form-row">
    <div class="form-group pl-3 pt-3">
      <%= f.search_field :nick_name_or_email_cont, placeholder: "名前、メールアドレス", class: "form-control"%>
    </div>
    <div class="form-group pl-3 pt-3">
      <%= f.submit "検索", class: "btn btn-primary" %>
    </div>
  </div>
<% end %>

<div>
  <% if @check.present? %>
    <% @result.each do |result| %>
      <div class="d-inline-flex p-2 bd-highlight col-12 border">
        <p><%= image_tag result.avatar_image.thumb.url,:size =>'50x50' %></p>
        <p class="pl-3 col-4 d-block"><%= result.nick_name.truncate(8) %></p>
        <div class="d-flex flex-row justify-content-end">
        <% if current_user != result %> <!-- フォローフォーム開始 -->
          <div id="index_follow_form">
            <% if current_user.following?(result) %>
              <%= form_for(current_user.active_relationships.find_by(followed_id: result.id),
              html: { method: :delete }, remote: true) do |f| %>
                <%= f.submit "フォロー中", class: "btn mt-3" %>
              <% end %>
            <% else %>
              <%= form_for(current_user.active_relationships.build, remote: true) do |f| %>
                <div><%= hidden_field_tag :followed_id, result.id %></div>
                <%= f.submit "フォロー", class: "btn btn-primary ml-3 mt-3" %>
              <% end %>
            <% end %>                  <!-- フォローフォーム終了 -->
          </div>
          <p><%= link_to "送る", "#", class: "btn btn-info m-3" %></p>
        <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>

